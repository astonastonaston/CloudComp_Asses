MAHOUT_LOCAL is not set; adding HADOOP_CONF_DIR to classpath.
Running on hadoop, using /usr/hdp/3.0.1.0-187/hadoop/bin/hadoop and HADOOP_CONF_DIR=/usr/hdp/3.0.1.0-187/hadoop/etc/hadoop
MAHOUT-JOB: /home/account0/HiBench3/hadoopbench/mahout/target/apache-mahout-distribution-0.11.0/mahout-examples-0.11.0-job.jar
21/11/21 01:59:22 WARN MahoutDriver: No trainnb.props found on classpath, will use command-line arguments only
21/11/21 01:59:22 INFO AbstractJob: Command line arguments: {--alphaI=[1.0], --endPhase=[2147483647], --input=[hdfs://cuhkcluster/dataspace/team12/HiBench/Bayes/Output/vectors/tfidf-vectors], --labelIndex=[hdfs://cuhkcluster/dataspace/team12/HiBench/Bayes/Output/labelindex], --output=[hdfs://cuhkcluster/dataspace/team12/HiBench/Bayes/Output/model], --overwrite=null, --startPhase=[0], --tempDir=[hdfs://cuhkcluster/dataspace/team12/HiBench/Bayes/Output/temp]}
21/11/21 01:59:27 INFO deprecation: mapred.input.dir is deprecated. Instead, use mapreduce.input.fileinputformat.inputdir
21/11/21 01:59:27 INFO deprecation: mapred.compress.map.output is deprecated. Instead, use mapreduce.map.output.compress
21/11/21 01:59:27 INFO deprecation: mapred.output.dir is deprecated. Instead, use mapreduce.output.fileoutputformat.outputdir
21/11/21 01:59:27 INFO AHSProxy: Connecting to Application History server at manager.cuhk.com/10.26.10.201:10200
21/11/21 01:59:27 INFO DFSClient: Created token for team12: HDFS_DELEGATION_TOKEN owner=team12@BIGDATA, renewer=yarn, realUser=, issueDate=1637431461718, maxDate=1638036261718, sequenceNumber=5339263, masterKeyId=677 on ha-hdfs:cuhkcluster
21/11/21 01:59:27 INFO KMSClientProvider: Getting new token from http://manager.cuhk.com:9292/kms/v1/, renewer:rm/master1.cuhk.com@BIGDATA
21/11/21 01:59:27 INFO KMSClientProvider: New token received: (Kind: kms-dt, Service: 10.26.10.201:9292, Ident: (kms-dt owner=team12, renewer=yarn, realUser=, issueDate=1637431461795, maxDate=1638036261795, sequenceNumber=36699, masterKeyId=288))
21/11/21 01:59:27 INFO TokenCache: Got dt for hdfs://cuhkcluster; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cuhkcluster, Ident: (token for team12: HDFS_DELEGATION_TOKEN owner=team12@BIGDATA, renewer=yarn, realUser=, issueDate=1637431461718, maxDate=1638036261718, sequenceNumber=5339263, masterKeyId=677)
21/11/21 01:59:27 INFO TokenCache: Got dt for hdfs://cuhkcluster; Kind: kms-dt, Service: 10.26.10.201:9292, Ident: (kms-dt owner=team12, renewer=yarn, realUser=, issueDate=1637431461795, maxDate=1638036261795, sequenceNumber=36699, masterKeyId=288)
21/11/21 01:59:27 INFO JobResourceUploader: Disabling Erasure Coding for path: /user/team12/.staging/job_1635647904527_12509
21/11/21 01:59:28 INFO FileInputFormat: Total input files to process : 1
21/11/21 01:59:28 INFO JobSubmitter: number of splits:3
21/11/21 01:59:28 INFO deprecation: yarn.resourcemanager.zk-num-retries is deprecated. Instead, use hadoop.zk.num-retries
21/11/21 01:59:28 INFO deprecation: yarn.resourcemanager.zk-address is deprecated. Instead, use hadoop.zk.address
21/11/21 01:59:28 INFO deprecation: yarn.resourcemanager.zk-timeout-ms is deprecated. Instead, use hadoop.zk.timeout-ms
21/11/21 01:59:28 INFO deprecation: yarn.resourcemanager.zk-acl is deprecated. Instead, use hadoop.zk.acl
21/11/21 01:59:28 INFO deprecation: yarn.resourcemanager.zk-retry-interval-ms is deprecated. Instead, use hadoop.zk.retry-interval-ms
21/11/21 01:59:28 INFO deprecation: yarn.resourcemanager.display.per-user-apps is deprecated. Instead, use yarn.webapp.filter-entity-list-by-user
21/11/21 01:59:28 INFO deprecation: yarn.resourcemanager.system-metrics-publisher.enabled is deprecated. Instead, use yarn.system-metrics-publisher.enabled
21/11/21 01:59:28 INFO JobSubmitter: Submitting tokens for job: job_1635647904527_12509
21/11/21 01:59:28 INFO JobSubmitter: Executing with tokens: [Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cuhkcluster, Ident: (token for team12: HDFS_DELEGATION_TOKEN owner=team12@BIGDATA, renewer=yarn, realUser=, issueDate=1637431461718, maxDate=1638036261718, sequenceNumber=5339263, masterKeyId=677), Kind: kms-dt, Service: 10.26.10.201:9292, Ident: (kms-dt owner=team12, renewer=yarn, realUser=, issueDate=1637431461795, maxDate=1638036261795, sequenceNumber=36699, masterKeyId=288)]
21/11/21 01:59:28 INFO Configuration: found resource resource-types.xml at file:/usr/hdp/3.0.1.0-187/hadoop/conf/resource-types.xml
21/11/21 01:59:28 INFO TimelineClientImpl: Timeline service address: manager.cuhk.com:8188
21/11/21 01:59:29 INFO YarnClientImpl: Submitted application application_1635647904527_12509
21/11/21 01:59:29 INFO Job: The url to track the job: http://master1.cuhk.com:8088/proxy/application_1635647904527_12509/
21/11/21 01:59:29 INFO Job: Running job: job_1635647904527_12509
21/11/21 01:59:38 INFO Job: Job job_1635647904527_12509 running in uber mode : false
21/11/21 01:59:38 INFO Job:  map 0% reduce 0%
21/11/21 01:59:52 INFO Job:  map 33% reduce 0%
21/11/21 01:59:53 INFO Job:  map 52% reduce 0%
21/11/21 01:59:56 INFO Job:  map 78% reduce 0%
21/11/21 02:00:05 INFO Job:  map 100% reduce 0%
21/11/21 02:00:06 INFO Job:  map 100% reduce 11%
21/11/21 02:00:09 INFO Job:  map 100% reduce 37%
21/11/21 02:00:13 INFO Job:  map 100% reduce 43%
21/11/21 02:00:31 INFO Job:  map 100% reduce 87%
21/11/21 02:00:34 INFO Job:  map 100% reduce 100%
21/11/21 02:00:34 INFO Job: Job job_1635647904527_12509 completed successfully
21/11/21 02:00:35 INFO Job: Counters: 53
	File System Counters
		FILE: Number of bytes read=120315629
		FILE: Number of bytes written=241620563
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=294385274
		HDFS: Number of bytes written=285686929
		HDFS: Number of read operations=17
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=2
	Job Counters
		Launched map tasks=3
		Launched reduce tasks=1
		Data-local map tasks=3
		Total time spent by all maps in occupied slots (ms)=185685
		Total time spent by all reduces in occupied slots (ms)=240084
		Total time spent by all map tasks (ms)=61895
		Total time spent by all reduce tasks (ms)=40014
		Total vcore-milliseconds taken by all map tasks=61895
		Total vcore-milliseconds taken by all reduce tasks=40014
		Total megabyte-milliseconds taken by all map tasks=190141440
		Total megabyte-milliseconds taken by all reduce tasks=245846016
	Map-Reduce Framework
		Map input records=100
		Map output records=100
		Map output bytes=285684052
		Map output materialized bytes=120312110
		Input split bytes=468
		Combine input records=100
		Combine output records=100
		Reduce input groups=100
		Reduce shuffle bytes=120312110
		Reduce input records=100
		Reduce output records=100
		Spilled Records=200
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=5930
		CPU time spent (ms)=156240
		Physical memory (bytes) snapshot=8550977536
		Virtual memory (bytes) snapshot=21498044416
		Total committed heap usage (bytes)=9175564288
		Peak Map Physical memory (bytes)=2402164736
		Peak Map Virtual memory (bytes)=4700983296
		Peak Reduce Physical memory (bytes)=1443823616
		Peak Reduce Virtual memory (bytes)=7416176640
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters
		Bytes Read=294384806
	File Output Format Counters
		Bytes Written=285686929
21/11/21 02:00:35 INFO AHSProxy: Connecting to Application History server at manager.cuhk.com/10.26.10.201:10200
21/11/21 02:00:35 INFO DFSClient: Created token for team12: HDFS_DELEGATION_TOKEN owner=team12@BIGDATA, renewer=yarn, realUser=, issueDate=1637431529111, maxDate=1638036329111, sequenceNumber=5339271, masterKeyId=677 on ha-hdfs:cuhkcluster
21/11/21 02:00:35 INFO KMSClientProvider: Getting new token from http://manager.cuhk.com:9292/kms/v1/, renewer:rm/master1.cuhk.com@BIGDATA
21/11/21 02:00:35 INFO KMSClientProvider: New token received: (Kind: kms-dt, Service: 10.26.10.201:9292, Ident: (kms-dt owner=team12, renewer=yarn, realUser=, issueDate=1637431529132, maxDate=1638036329132, sequenceNumber=36701, masterKeyId=288))
21/11/21 02:00:35 INFO TokenCache: Got dt for hdfs://cuhkcluster; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cuhkcluster, Ident: (token for team12: HDFS_DELEGATION_TOKEN owner=team12@BIGDATA, renewer=yarn, realUser=, issueDate=1637431529111, maxDate=1638036329111, sequenceNumber=5339271, masterKeyId=677)
21/11/21 02:00:35 INFO TokenCache: Got dt for hdfs://cuhkcluster; Kind: kms-dt, Service: 10.26.10.201:9292, Ident: (kms-dt owner=team12, renewer=yarn, realUser=, issueDate=1637431529132, maxDate=1638036329132, sequenceNumber=36701, masterKeyId=288)
21/11/21 02:00:35 INFO JobResourceUploader: Disabling Erasure Coding for path: /user/team12/.staging/job_1635647904527_12511
21/11/21 02:00:35 INFO FileInputFormat: Total input files to process : 1
21/11/21 02:00:35 INFO JobSubmitter: number of splits:3
21/11/21 02:00:35 INFO deprecation: yarn.resourcemanager.zk-num-retries is deprecated. Instead, use hadoop.zk.num-retries
21/11/21 02:00:35 INFO deprecation: yarn.resourcemanager.zk-address is deprecated. Instead, use hadoop.zk.address
21/11/21 02:00:35 INFO deprecation: yarn.resourcemanager.zk-timeout-ms is deprecated. Instead, use hadoop.zk.timeout-ms
21/11/21 02:00:35 INFO deprecation: yarn.resourcemanager.zk-acl is deprecated. Instead, use hadoop.zk.acl
21/11/21 02:00:35 INFO deprecation: yarn.resourcemanager.zk-retry-interval-ms is deprecated. Instead, use hadoop.zk.retry-interval-ms
21/11/21 02:00:35 INFO deprecation: yarn.resourcemanager.display.per-user-apps is deprecated. Instead, use yarn.webapp.filter-entity-list-by-user
21/11/21 02:00:35 INFO deprecation: yarn.resourcemanager.system-metrics-publisher.enabled is deprecated. Instead, use yarn.system-metrics-publisher.enabled
21/11/21 02:00:35 INFO JobSubmitter: Submitting tokens for job: job_1635647904527_12511
21/11/21 02:00:35 INFO JobSubmitter: Executing with tokens: [Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cuhkcluster, Ident: (token for team12: HDFS_DELEGATION_TOKEN owner=team12@BIGDATA, renewer=yarn, realUser=, issueDate=1637431529111, maxDate=1638036329111, sequenceNumber=5339271, masterKeyId=677), Kind: kms-dt, Service: 10.26.10.201:9292, Ident: (kms-dt owner=team12, renewer=yarn, realUser=, issueDate=1637431529132, maxDate=1638036329132, sequenceNumber=36701, masterKeyId=288)]
21/11/21 02:00:35 INFO TimelineClientImpl: Timeline service address: manager.cuhk.com:8188
21/11/21 02:00:35 INFO YarnClientImpl: Submitted application application_1635647904527_12511
21/11/21 02:00:35 INFO Job: The url to track the job: http://master1.cuhk.com:8088/proxy/application_1635647904527_12511/
21/11/21 02:00:35 INFO Job: Running job: job_1635647904527_12511
21/11/21 02:00:46 INFO Job: Job job_1635647904527_12511 running in uber mode : false
21/11/21 02:00:46 INFO Job:  map 0% reduce 0%
21/11/21 02:00:58 INFO Job:  map 33% reduce 0%
21/11/21 02:01:01 INFO Job:  map 41% reduce 0%
21/11/21 02:01:04 INFO Job:  map 61% reduce 0%
21/11/21 02:01:07 INFO Job:  map 78% reduce 0%
21/11/21 02:01:10 INFO Job:  map 89% reduce 11%
21/11/21 02:01:12 INFO Job:  map 100% reduce 11%
21/11/21 02:01:13 INFO Job:  map 100% reduce 37%
21/11/21 02:01:16 INFO Job:  map 100% reduce 67%
21/11/21 02:01:19 INFO Job:  map 100% reduce 85%
21/11/21 02:01:23 INFO Job:  map 100% reduce 100%
21/11/21 02:01:25 INFO Job: Job job_1635647904527_12511 completed successfully
21/11/21 02:01:25 INFO Job: Counters: 53
	File System Counters
		FILE: Number of bytes read=39058919
		FILE: Number of bytes written=79118730
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=294384121
		HDFS: Number of bytes written=49527797
		HDFS: Number of read operations=17
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=2
	Job Counters
		Launched map tasks=3
		Launched reduce tasks=1
		Data-local map tasks=3
		Total time spent by all maps in occupied slots (ms)=165306
		Total time spent by all reduces in occupied slots (ms)=142236
		Total time spent by all map tasks (ms)=55102
		Total time spent by all reduce tasks (ms)=23706
		Total vcore-milliseconds taken by all map tasks=55102
		Total vcore-milliseconds taken by all reduce tasks=23706
		Total megabyte-milliseconds taken by all map tasks=169273344
		Total megabyte-milliseconds taken by all reduce tasks=145649664
	Map-Reduce Framework
		Map input records=100
		Map output records=6
		Map output bytes=90058712
		Map output materialized bytes=39060089
		Input split bytes=474
		Combine input records=6
		Combine output records=6
		Reduce input groups=2
		Reduce shuffle bytes=39060089
		Reduce input records=6
		Reduce output records=2
		Spilled Records=12
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=9007
		CPU time spent (ms)=227100
		Physical memory (bytes) snapshot=7412518912
		Virtual memory (bytes) snapshot=21438717952
		Total committed heap usage (bytes)=9015656448
		Peak Map Physical memory (bytes)=2621386752
		Peak Map Virtual memory (bytes)=4754178048
		Peak Reduce Physical memory (bytes)=1413492736
		Peak Reduce Virtual memory (bytes)=7385415680
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters
		Bytes Read=294383647
	File Output Format Counters
		Bytes Written=49527797
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
	at org.apache.mahout.math.map.OpenIntDoubleHashMap.rehash(OpenIntDoubleHashMap.java:489)
	at org.apache.mahout.math.map.OpenIntDoubleHashMap.put(OpenIntDoubleHashMap.java:442)
	at org.apache.mahout.math.RandomAccessSparseVector.setQuick(RandomAccessSparseVector.java:128)
	at org.apache.mahout.math.VectorWritable.readFields(VectorWritable.java:125)
	at org.apache.mahout.math.VectorWritable.readFields(VectorWritable.java:89)
	at org.apache.hadoop.io.SequenceFile$Reader.getCurrentValue(SequenceFile.java:2308)
	at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:2436)
	at org.apache.mahout.common.iterator.sequencefile.SequenceFileIterator.computeNext(SequenceFileIterator.java:101)
	at org.apache.mahout.common.iterator.sequencefile.SequenceFileIterator.computeNext(SequenceFileIterator.java:40)
	at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:143)
	at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:138)
	at com.google.common.collect.Iterators$5.hasNext(Iterators.java:543)
	at com.google.common.collect.ForwardingIterator.hasNext(ForwardingIterator.java:43)
	at org.apache.mahout.classifier.naivebayes.BayesUtils.readModelFromDir(BayesUtils.java:78)
	at org.apache.mahout.classifier.naivebayes.training.TrainNaiveBayesJob.run(TrainNaiveBayesJob.java:160)
	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:76)
	at org.apache.mahout.classifier.naivebayes.training.TrainNaiveBayesJob.main(TrainNaiveBayesJob.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:71)
	at org.apache.hadoop.util.ProgramDriver.run(ProgramDriver.java:144)
	at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:152)
	at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:318)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:232)
